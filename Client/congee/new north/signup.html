<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign Up</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <main class="page-container">
      <section class="signup-container">
        <h1 class="signup-title">Sign Up</h1>
        <form class="signup-form" id="signupForm">
          <div class="form-group">
            <input
              type="text"
              placeholder="Name"
              class="form-input"
              aria-label="Name"
              id="nameInput"
            />
          </div>
          <div class="form-group">
            <input
              type="email"
              placeholder="Email"
              class="form-input"
              aria-label="Email"
              id="emailInput"
            />
          </div>
          <div class="form-group">
            <input
              type="password"
              placeholder="Password"
              class="form-input"
              aria-label="Password"
              id="passwordInput"
            />
          </div>

          <p id="errorMsg" style="color: red; font-family: Poppins, sans-serif; margin-bottom: 10px;"></p>

          <button type="submit" class="signup-button">Create Account</button>
        </form>
        <p class="login-text">
          Already have an account?
          <a href="login.html"> Login</a>
        </p>
      </section>
    </main>

    <script>
      document.getElementById('signupForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const username = document.getElementById('nameInput').value.trim();
        const email = document.getElementById('emailInput').value.trim();
        const password = document.getElementById('passwordInput').value.trim();
        const errorMsg = document.getElementById('errorMsg');

        if (username === '' || email === '' || password === '') {
          errorMsg.textContent = 'All fields are required.';
          return;
        }

        if (password.length < 6) {
          errorMsg.textContent = 'Password must be at least 6 characters.';
          return;
        }

        // Get existing users or initialize empty array
        const users = JSON.parse(localStorage.getItem('users')) || [];

        // Check if user already exists
        const userExists = users.some(user => user.email === email);
        if (userExists) {
          errorMsg.textContent = 'Email is already registered.';
          return;
        }

        // Add new user
        const newUser = { username, email, password, role: 'user' }; // Default role
        users.push(newUser);
        localStorage.setItem('users', JSON.stringify(users));

        errorMsg.textContent = '';
        alert('Signup successful! Redirecting to login...');
        window.location.href = 'login.html';
      });

    </script>
  </body>
</html>
